<!DOCTYPE html>
<html lang="en">
<head>
  <title>Tank</title>
  <style>
    body {
      margin: 0;
    }
    .buttons {
      position: relative;
      width: 8rem;
      height: 7rem;
      top: 2rem;
    }
    .button {
      position: absolute;
      width: 2rem;
      height: 2rem;
    }
    .up {
      top: 0;
      left: 4rem;
    }

    .down {
      bottom: 0;
      left: 4rem;
    }

    .right {
      top: 2.5rem;
      right: 0;
    }

    .left {
      top: 2.5rem;
      left: 2rem;
    }
  </style>
</head>
<body onload="randBoom()">
  <div style="border: 1px solid black; height: 190px; width: 190px; background-color: rgb(255, 255, 255);">
    <img id="tank"
      src="./img/tank.png"
      style="position: relative; top: 0px; left: 0px;"
      width="19"
      height="19">

      <img id="boom"
      src="./img/boom.png"
      style="position: relative;"
      width="19"
      height="19">
  </div>

  <div class="buttons">
    <button id="upBtn" class="button up" value="up" onclick="moveUp()">&uarr;</button>
    <button id="downBtn" class="button down" value="down" onclick="moveDown()">&darr;</button>
    <button id="rightBtn" class="button right" value="right" onclick="moveRight()">&rarr;</button>
    <button id="leftBtn" class="button left" value="left" onclick="moveLeft()">&larr;</button>
  </div>

  <script>
    const tank = document.getElementById("tank");
    const boom = document.getElementById("boom");

    function randBoom(){
      let boomTop = Math.floor(Math.random() * 190);
      let boomLeft = Math.floor(Math.random() * 190);
      boom.style.top = boomTop + "px";
      boom.style.left = boomLeft + "px";
    }

    function getPostion(ele){
      return {
        left: ele.offsetLeft,
        top : ele.offsetTop,
      }
    }

    function moveUp(){
      let currPostion = getPostion(tank);
      let boomPosition = getPostion(boom);
      // Lấy top hiện tại - 19px
      if(currPostion.top - 19 > 0 ) {
        tank.style.top = currPostion.top -  19 + "px";
        tank.style.transform = "rotate(0deg)";
      }
    }

    function moveDown(){
      let currPostion = getPostion(tank);
      let boomPosition = getPostion(boom);
      // lấy top hiện tại + 19px
      if(currPostion.top + 19 < 189){
        tank.style.top = currPostion.top +  19 + "px";
        tank.style.transform = "rotate(180deg)";
      }
    }
    function moveRight(){
      let currPostion = getPostion(tank);
      let boomPosition = getPostion(boom);
      if(currPostion.left + 19 < 189) {
        tank.style.left = currPostion.left +  19 + "px";
        tank.style.transform = "rotate(90deg)";
      }

      let newPostion = getPostion(tank);
      if(newPostion.left + 19 > boomPosition.left && newPostion.top > boomPosition.top) {
        tank.src = "./img/explosion.png";
      }
    }

    function moveLeft(){
      let currPostion = getPostion(tank);
      let boomPosition = getPostion(boom);
      if(currPostion.left - 19 > 0 ) {
        tank.style.left = currPostion.left -  19 + "px";
        tank.style.transform = "rotate(270deg)";
      }

    }

  </script>
</body>
</html>